{
  "name": "Dropbox â†’ AWS S3 : Hourly Backup",
  "nodes": [
    {
      "parameters": { "cronExpression": "0 */4 * * *" },
      "name": "Cron",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [250, 300][250, 300]
    },
    {
      "parameters": {
        "operation": "list",
        "path": "/backups",
        "returnAll": true
      },
      "name": "List Backups",
      "type": "n8n-nodes-base.dropbox",
      "typeVersion": 1,
      "position": [450, 300][450, 300]
    },
    {
      "parameters": {
        "functionCode": "return items.map(item => ({ json: item.json, binary: item.binary }));"
      },
      "name": "Pass Through",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [650, 300][650, 300]
    },
    {
      "parameters": {
        "operation": "upload",
        "bucket": "prod-backups",
        "key": "{{ $json.path_display }}",
        "binaryPropertyName": "binary",
        "options": {
          "serverSideEncryption": "AES256"
        }
      },
      "name": "Upload to S3",
      "type": "n8n-nodes-base.awsS3",
      "typeVersion": 1,
      "position": [850, 300][850, 300]
    },
    {
      "parameters": {
        "operation": "move",
        "path": "/archived/{{ $json.name }}"
      },
      "name": "Archive Locally",
      "type": "n8n-nodes-base.dropbox",
      "typeVersion": 1,
      "position": [1050, 300][1050, 300]
    }
  ],
  "connections": {
    "Cron": { "main": [["List Backups", "main"]] },
    "List Backups": { "main": [["Pass Through", "main"]] },
    "Pass Through": { "main": [["Upload to S3", "main"]] },
    "Upload to S3": { "main": [["Archive Locally", "main"]] }
  }
}
